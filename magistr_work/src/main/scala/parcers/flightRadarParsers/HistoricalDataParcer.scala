package parcers.flightRadarParsers

import com.mongodb.{BasicDBList, BasicDBObject}
import entity.{Historical, TimeData, Traectory, ValuableRealtimeDataMongo}

object HistoricalDataParcer {

  def timePArcer(str: String): TimeData = {
    val inputdata = str.replace("\"historical\":null", "historical\":{\"departure\":null,\"arrival\":null}")
    val data = inputdata.split(":|,|}").map(d => {
      if (d == "null") "1" else d
    })

    TimeData(data(1).toLong, data(3).toLong, data(7).toLong, data(10 - 1).toLong, data(14 - 1).toLong, data(16 - 1).toLong, data(20 - 1).toLong, data(22 - 1).toLong, data(26 - 1).replaceAll("\"", "").toLong, data(28 - 1).replaceAll("\"", "").toLong)
  }

  def TRAECTORYPArcer(str: String): Array[Traectory] = {
    def createTraectoria(str: String): Traectory = {
      val data = str.split(":|,")
      Traectory(data(1).toDouble, data(3).toDouble, data(5), data(7).toInt, data(9).toLong, if (data.length > 11) {
        data(11).toLong
      } else 0)
    }

    val data = str.substring(4, str.length - 4).split("\\},\\{")
    data.map(createTraectoria)
  }

  //  {"identification":{"id":"1e8f5a99","row":4836111114,"number":{"default":"FR1888","alternative":null},"callsign":"RYR1888"},"status":{"live":false,"text":"Landed 12:39","icon":"green","estimated":null,"ambiguous":false,"generic":{"status":{"text":"landed","color":"green","type":"arrival"},"eventTime":{"utc":1542278377,"local":1542285577}}},"level":"limited","aircraft":{"model":{"code":"B738","text":"Boeing 737-8AS"},"registration":"EI-GDV","hex":"4cac99","age":null,"msn":null,"images":{"thumbnails":[{"src":"https:\/\/cdn.jetphotos.com\/200\/5\/28040_1536570643_tb.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/9070912","copyright":"Marcin G. Dabrowski","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/200\/5\/61310_1535637726_tb.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/9061046","copyright":"\u0141ukasz Stawiarz","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/200\/6\/42723_1530816278_tb.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/9008338","copyright":"Giovanni Curto","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/200\/6\/55060_1528133028_tb.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/8980416","copyright":"Juan Luis L\u00f3pez Montes","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/200\/6\/60129_1524978612_tb.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/8942005","copyright":"M. Azizul Islam","source":"Jetphotos"}],"medium":[{"src":"https:\/\/cdn.jetphotos.com\/400\/5\/28040_1536570643.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/9070912","copyright":"Marcin G. Dabrowski","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/400\/5\/61310_1535637726.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/9061046","copyright":"\u0141ukasz Stawiarz","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/400\/6\/42723_1530816278.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/9008338","copyright":"Giovanni Curto","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/400\/6\/55060_1528133028.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/8980416","copyright":"Juan Luis L\u00f3pez Montes","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/400\/6\/60129_1524978612.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/8942005","copyright":"M. Azizul Islam","source":"Jetphotos"}],"large":[{"src":"https:\/\/cdn.jetphotos.com\/640cb\/5\/28040_1536570643.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/9070912","copyright":"Marcin G. Dabrowski","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/640cb\/5\/61310_1535637726.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/9061046","copyright":"\u0141ukasz Stawiarz","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/640cb\/6\/42723_1530816278.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/9008338","copyright":"Giovanni Curto","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/640cb\/6\/55060_1528133028.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/8980416","copyright":"Juan Luis L\u00f3pez Montes","source":"Jetphotos"},{"src":"https:\/\/cdn.jetphotos.com\/640cb\/6\/60129_1524978612.jpg?v=0","link":"https:\/\/www.jetphotos.com\/photo\/8942005","copyright":"M. Azizul Islam","source":"Jetphotos"}]}},"airline":{"name":"Ryanair","short":"Ryanair","code":{"iata":"FR","icao":"RYR"},"url":"ryanair-ryr"},"owner":null,"airspace":null,"airport":{"origin":{"name":"Karlsruhe\/Baden-Baden Airport","code":{"iata":"FKB","icao":"EDSB"},"position":{"latitude":48.77935,"longitude":8.0805,"altitude":408,"country":{"name":"Germany","code":"DEU"},"region":{"city":"Karlsruhe\/Baden-Baden"}},"timezone":{"name":"Europe\/Berlin","offset":3600,"offsetHours":"1:00","abbr":"CET","abbrName":"Central European Time","isDst":false},"visible":true,"website":"http:\/\/www.baden-airpark.de\/startseite.html?&L=1","info":{"terminal":null,"baggage":null,"gate":null}},"destination":{"name":"Tel Aviv Ben Gurion International Airport","code":{"iata":"TLV","icao":"LLBG"},"position":{"latitude":32.011379,"longitude":34.886662,"altitude":135,"country":{"name":"Israel","code":"ISR"},"region":{"city":"Tel Aviv"}},"timezone":{"name":"Asia\/Jerusalem","offset":7200,"offsetHours":"2:00","abbr":"IST","abbrName":"Israel Standard Time","isDst":false},"visible":true,"website":"http:\/\/www.iaa.gov.il\/Rashat\/en-US\/Airports\/BenGurion\/","info":{"terminal":"3","baggage":null,"gate":null}},"real":null},"flightHistory":{"aircraft":[{"identification":{"id":"1e8df9a0","number":{"default":"FR8772"}},"airport":{"origin":{"name":"Bari Karol Wojtyla Airport","code":{"iata":"BRI","icao":"LIBD"},"position":{"latitude":41.138851,"longitude":16.76059,"altitude":177,"country":{"name":"Italy","code":"ITA"},"region":{"city":"Bari"}},"timezone":{"name":"Europe\/Rome","offset":3600,"offsetHours":"1:00","abbr":"CET","abbrName":"Central European Time","isDst":false},"visible":true,"website":"http:\/\/www.aeroportidipuglia.it\/index.asp?idlingua=2&"},"destination":{"name":"Karlsruhe\/Baden-Baden Airport","code":{"iata":"FKB","icao":"EDSB"},"position":{"latitude":48.77935,"longitude":8.0805,"altitude":408,"country":{"name":"Germany","code":"DEU"},"region":{"city":"Karlsruhe\/Baden-Baden"}},"timezone":{"name":"Europe\/Berlin","offset":3600,"offsetHours":"1:00","abbr":"CET","abbrName":"Central European Time","isDst":false},"visible":true,"website":"http:\/\/www.baden-airpark.de\/startseite.html?&L=1"}},"time":{"real":{"departure":1542221722}}},{"identification":{"id":"1e8d9f59","number":{"default":"FR8773"}},"airport":{"origin":{"name":"Karlsruhe\/Baden-Baden Airport","code":{"iata":"FKB","icao":"EDSB"},"position":{"latitude":48.77935,"longitude":8.0805,"altitude":408,"country":{"name":"Germany","code":"DEU"},"region":{"city":"Karlsruhe\/Baden-Baden"}},"timezone":{"name":"Europe\/Berlin","offset":3600,"offsetHours":"1:00","abbr":"CET","abbrName":"Central European Time","isDst":false},"visible":true,"website":"http:\/\/www.baden-airpark.de\/startseite.html?&L=1"},"destination":{"name":"Bari Karol Wojtyla Airport","code":{"iata":"BRI","icao":"LIBD"},"position":{"latitude":41.138851,"longitude":16.76059,"altitude":177,"country":{"name":"Italy","code":"ITA"},"region":{"city":"Bari"}},"timezone":{"name":"Europe\/Rome","offset":3600,"offsetHours":"1:00","abbr":"CET","abbrName":"Central European Time","isDst":false},"visible":true,"website":"http:\/\/www.aeroportidipuglia.it\/index.asp?idlingua=2&"}},"time":{"real":{"departure":1542213103}}},{"identification":{"id":"1e8d543c","number":{"default":"FR9772"}},"airport":{"origin":{"name":"London Stansted Airport","code":{"iata":"STN","icao":"EGSS"},"position":{"latitude":51.884998,"longitude":0.235,"altitude":348,"country":{"name":"United Kingdom","code":"GBR"},"region":{"city":"London"}},"timezone":{"name":"Europe\/London","offset":0,"offsetHours":"0:00","abbr":"GMT","abbrName":"Greenwich Mean Time","isDst":false},"visible":true,"website":"http:\/\/www.stanstedairport.com\/"},"destination":{"name":"Karlsruhe\/Baden-Baden Airport","code":{"iata":"FKB","icao":"EDSB"},"position":{"latitude":48.77935,"longitude":8.0805,"altitude":408,"country":{"name":"Germany","code":"DEU"},"region":{"city":"Karlsruhe\/Baden-Baden"}},"timezone":{"name":"Europe\/Berlin","offset":3600,"offsetHours":"1:00","abbr":"CET","abbrName":"Central European Time","isDst":false},"visible":true,"website":"http:\/\/www.baden-airpark.de\/startseite.html?&L=1"}},"time":{"real":{"departure":1542205850}}},{"identification":{"id":"1e8d0712","number":{"default":"FR9773"}},"airport":{"origin":{"name":"Karlsruhe\/Baden-Baden Airport","code":{"iata":"FKB","icao":"EDSB"},"position":{"latitude":48.77935,"longitude":8.0805,"altitude":408,"country":{"name":"Germany","code":"DEU"},"region":{"city":"Karlsruhe\/Baden-Baden"}},"timezone":{"name":"Europe\/Berlin","offset":3600,"offsetHours":"1:00","abbr":"CET","abbrName":"Central European Time","isDst":false},"visible":true,"website":"http:\/\/www.baden-airpark.de\/startseite.html?&L=1"},"destination":{"name":"London Stansted Airport","code":{"iata":"STN","icao":"EGSS"},"position":{"latitude":51.884998,"longitude":0.235,"altitude":348,"country":{"name":"United Kingdom","code":"GBR"},"region":{"city":"London"}},"timezone":{"name":"Europe\/London","offset":0,"offsetHours":"0:00","abbr":"GMT","abbrName":"Greenwich Mean Time","isDst":false},"visible":true,"website":"http:\/\/www.stanstedairport.com\/"}},"time":{"real":{"departure":1542199193}}}]},"ems":null,"availability":["AGE","MSN"],"time":{"scheduled":{"departure":1542265200,"arrival":1542280200},"real":{"departure":1542265740,"arrival":1542278377},"estimated":{"departure":null,"arrival":null},"other":{"eta":1542278377,"updated":1542276340},"historical":{"flighttime":"13924","delay":"-805"}},"trail":[{"lat":32.010269,"lng":34.870522,"alt":0,"spd":23,"ts":1542278486,"hd":174},{"lat":31.997309,"lng":34.899303,"alt":325,"spd":148,"ts":1542278389,"hd":301},{"lat":31.995167,"lng":34.903454,"alt":400,"spd":148,"ts":1542278382,"hd":301},{"lat":31.991364,"lng":34.910816,"alt":550,"spd":147,"ts":1542278372,"hd":301},{"lat":31.969345,"lng":34.952782,"alt":1450,"spd":167,"ts":1542278314,"hd":299},{"lat":31.9657,"lng":34.960011,"alt":1575,"spd":167,"ts":1542278304,"hd":299},{"lat":31.961334,"lng":34.967396,"alt":1700,"spd":169,"ts":1542278295,"hd":320},{"lat":31.958065,"lng":34.970547,"alt":1775,"spd":170,"ts":1542278289,"hd":328},{"lat":31.951408,"lng":34.974918,"alt":1850,"spd":171,"ts":1542278279,"hd":332},{"lat":31.947098,"lng":34.977612,"alt":1925,"spd":170,"ts":1542278273,"hd":331},{"lat":31.942932,"lng":34.980305,"alt":1975,"spd":171,"ts":1542278267,"hd":330},{"lat":31.938766,"lng":34.983105,"alt":2025,"spd":171,"ts":1542278261,"hd":329},{"lat":31.925079,"lng":34.988323,"alt":2200,"spd":173,"ts":1542278241,"hd":1},{"lat":31.918167,"lng":34.986786,"alt":2275,"spd":174,"ts":1542278234,"hd":24},{"lat":31.905853,"lng":34.972504,"alt":2500,"spd":179,"ts":1542278213,"hd":61},{"lat":31.903505,"lng":34.967522,"alt":2550,"spd":179,"ts":1542278207,"hd":60},{"lat":31.898245,"lng":34.94437,"alt":2800,"spd":186,"ts":1542278181,"hd":105},{"lat":31.900759,"lng":34.93602,"alt":2900,"spd":188,"ts":1542278172,"hd":123},{"lat":31.906265,"lng":34.927734,"alt":3000,"spd":192,"ts":1542278162,"hd":131},{"lat":31.909378,"lng":34.923668,"alt":3075,"spd":193,"ts":1542278156,"hd":132},{"lat":31.915516,"lng":34.915615,"alt":3175,"spd":197,"ts":1542278145,"hd":131},{"lat":31.922195,"lng":34.906639,"alt":3300,"spd":201,"ts":1542278135,"hd":131},{"lat":31.92746,"lng":34.899719,"alt":3400,"spd":206,"ts":1542278128,"hd":131},{"lat":31.933439,"lng":34.891739,"alt":3525,"spd":210,"ts":1542278117,"hd":131},{"lat":31.945356,"lng":34.875763,"alt":3825,"spd":216,"ts":1542278098,"hd":131},{"lat":31.953922,"lng":34.864216,"alt":4000,"spd":223,"ts":1542278086,"hd":130},{"lat":31.96138,"lng":34.854015,"alt":4150,"spd":228,"ts":1542278075,"hd":130},{"lat":31.968771,"lng":34.844036,"alt":4300,"spd":231,"ts":1542278064,"hd":131},{"lat":31.975521,"lng":34.8349,"alt":4425,"spd":233,"ts":1542278054,"hd":130},{"lat":31.98311,"lng":34.825092,"alt":4525,"spd":234,"ts":1542278044,"hd":137},{"lat":31.988159,"lng":34.819794,"alt":4525,"spd":234,"ts":1542278038,"hd":141},{"lat":32.001732,"lng":34.809452,"alt":4525,"spd":233,"ts":1542278023,"hd":152},{"lat":32.011368,"lng":34.803566,"alt":4550,"spd":234,"ts":1542278014,"hd":152},{"lat":32.037369,"lng":34.787548,"alt":4825,"spd":235,"ts":1542277987,"hd":152},{"lat":32.050423,"lng":34.77969,"alt":4950,"spd":236,"ts":1542277975,"hd":151},{"lat":32.05513,"lng":34.776451,"alt":5000,"spd":235,"ts":1542277968,"hd":144},{"lat":32.062637,"lng":34.769367,"alt":5025,"spd":234,"ts":1542277959,"hd":134},{"lat":32.070694,"lng":34.757282,"alt":5025,"spd":236,"ts":1542277947,"hd":121},{"lat":32.077744,"lng":34.743549,"alt":5050,"spd":238,"ts":1542277934,"hd":121},{"lat":32.08287,"lng":34.733501,"alt":5100,"spd":239,"ts":1542277926,"hd":120},{"lat":32.089874,"lng":34.719765,"alt":5175,"spd":243,"ts":1542277913,"hd":120},{"lat":32.097107,"lng":34.705536,"alt":5250,"spd":250,"ts":1542277901,"hd":120},{"lat":32.104191,"lng":34.691574,"alt":5350,"spd":257,"ts":1542277890,"hd":121},{"lat":32.111687,"lng":34.677055,"alt":5450,"spd":264,"ts":1542277877,"hd":121},{"lat":32.119629,"lng":34.661919,"alt":5550,"spd":269,"ts":1542277865,"hd":121},{"lat":32.127777,"lng":34.646374,"alt":5625,"spd":271,"ts":1542277853,"hd":121},{"lat":32.136108,"lng":34.630116,"alt":5725,"spd":274,"ts":1542277842,"hd":121},{"lat":32.280487,"lng":34.378857,"alt":8025,"spd":365,"ts":1542277664,"hd":126},{"lat":32.310978,"lng":34.330032,"alt":8675,"spd":362,"ts":1542277633,"hd":126},{"lat":32.362278,"lng":34.24786,"alt":9775,"spd":366,"ts":1542277581,"hd":126},{"lat":32.381836,"lng":34.216316,"alt":10200,"spd":371,"ts":1542277562,"hd":125},{"lat":32.41832,"lng":34.156879,"alt":10925,"spd":380,"ts":1542277527,"hd":125},{"lat":32.43544,"lng":34.129139,"alt":11400,"spd":385,"ts":1542277510,"hd":126},{"lat":32.484711,"lng":34.049656,"alt":13125,"spd":395,"ts":1542277464,"hd":126},{"lat":32.522873,"lng":33.988075,"alt":14475,"spd":402,"ts":1542277429,"hd":126},{"lat":32.561417,"lng":33.925453,"alt":15800,"spd":411,"ts":1542277394,"hd":125},{"lat":32.634098,"lng":33.805492,"alt":18325,"spd":424,"ts":1542277331,"hd":125},{"lat":32.704514,"lng":33.690178,"alt":20650,"spd":439,"ts":1542277268,"hd":125},{"lat":32.782505,"lng":33.563736,"alt":22950,"spd":460,"ts":1542277205,"hd":126},{"lat":32.860386,"lng":33.431622,"alt":24600,"spd":478,"ts":1542277142,"hd":123},{"lat":32.938969,"lng":33.290649,"alt":27300,"spd":497,"ts":1542277080,"hd":123},{"lat":33.011398,"lng":33.149269,"alt":29900,"spd":496,"ts":1542277020,"hd":120},{"lat":33.085648,"lng":32.999413,"alt":30900,"spd":505,"ts":1542276956,"hd":120},{"lat":33.162788,"lng":32.848953,"alt":31900,"spd":495,"ts":1542276892,"hd":121},{"lat":33.23497,"lng":32.709209,"alt":32825,"spd":493,"ts":1542276833,"hd":121},{"lat":33.30859,"lng":32.566784,"alt":33700,"spd":464,"ts":1542276768,"hd":121},{"lat":33.378605,"lng":32.42979,"alt":34750,"spd":458,"ts":1542276706,"hd":121},{"lat":33.446411,"lng":32.297222,"alt":35825,"spd":481,"ts":1542276646,"hd":121},{"lat":33.521622,"lng":32.149731,"alt":37000,"spd":509,"ts":1542276582,"hd":121},{"lat":33.599396,"lng":31.996279,"alt":37000,"spd":510,"ts":1542276518,"hd":121},{"lat":33.680916,"lng":31.836205,"alt":37000,"spd":511,"ts":1542276454,"hd":121},{"lat":33.817593,"lng":31.563206,"alt":37000,"spd":509,"ts":1542276340,"hd":120},{"lat":34.569351,"lng":30.032753,"alt":37000,"spd":505,"ts":1542275715,"hd":125},{"lat":34.582718,"lng":30.010948,"alt":37000,"spd":505,"ts":1542275708,"hd":128},{"lat":34.657024,"lng":29.92321,"alt":37000,"spd":504,"ts":1542275661,"hd":139},{"lat":34.763397,"lng":29.812243,"alt":37000,"spd":504,"ts":1542275601,"hd":139},{"lat":34.870331,"lng":29.699968,"alt":37000,"spd":509,"ts":1542275541,"hd":139},{"lat":34.983727,"lng":29.581032,"alt":37000,"spd":517,"ts":1542275478,"hd":139},{"lat":35.098896,"lng":29.459724,"alt":37000,"spd":517,"ts":1542275414,"hd":139},{"lat":35.25983,"lng":29.289434,"alt":37000,"spd":514,"ts":1542275325,"hd":138},{"lat":35.306808,"lng":29.239426,"alt":37000,"spd":513,"ts":1542275298,"hd":138},{"lat":35.417221,"lng":29.121437,"alt":37000,"spd":510,"ts":1542275238,"hd":138},{"lat":35.526352,"lng":29.004593,"alt":37000,"spd":508,"ts":1542275176,"hd":138},{"lat":35.637787,"lng":28.884752,"alt":37000,"spd":507,"ts":1542275113,"hd":138},{"lat":35.749603,"lng":28.764311,"alt":37000,"spd":505,"ts":1542275049,"hd":138},{"lat":35.861115,"lng":28.643761,"alt":37000,"spd":508,"ts":1542274986,"hd":138},{"lat":35.971939,"lng":28.523254,"alt":37000,"spd":510,"ts":1542274924,"hd":138},{"lat":36.084045,"lng":28.401089,"alt":37000,"spd":514,"ts":1542274861,"hd":138},{"lat":36.19688,"lng":28.277523,"alt":37000,"spd":515,"ts":1542274796,"hd":138},{"lat":36.304367,"lng":28.159389,"alt":37000,"spd":517,"ts":1542274737,"hd":138},{"lat":36.414276,"lng":28.038025,"alt":37000,"spd":516,"ts":1542274673,"hd":138},{"lat":36.526936,"lng":27.912462,"alt":37000,"spd":517,"ts":1542274611,"hd":138},{"lat":36.639771,"lng":27.787399,"alt":37000,"spd":514,"ts":1542274547,"hd":137},{"lat":36.750992,"lng":27.662815,"alt":37000,"spd":513,"ts":1542274486,"hd":137},{"lat":36.863785,"lng":27.535738,"alt":37000,"spd":509,"ts":1542274420,"hd":137},{"lat":36.967598,"lng":27.41889,"alt":37000,"spd":511,"ts":1542274360,"hd":137},{"lat":37.078159,"lng":27.29398,"alt":37000,"spd":511,"ts":1542274298,"hd":137},{"lat":37.188862,"lng":27.168472,"alt":37000,"spd":511,"ts":1542274236,"hd":137},{"lat":37.299236,"lng":27.04237,"alt":37000,"spd":511,"ts":1542274171,"hd":137},{"lat":37.413662,"lng":26.91119,"alt":37000,"spd":511,"ts":1542274106,"hd":137},{"lat":37.521709,"lng":26.786877,"alt":37000,"spd":510,"ts":1542274045,"hd":137},{"lat":37.630508,"lng":26.661364,"alt":37000,"spd":516,"ts":1542273982,"hd":137},{"lat":37.743027,"lng":26.530756,"alt":37000,"spd":517,"ts":1542273919,"hd":137},{"lat":37.847248,"lng":26.409163,"alt":36975,"spd":517,"ts":1542273858,"hd":137},{"lat":37.958927,"lng":26.2787,"alt":37000,"spd":518,"ts":1542273794,"hd":137},{"lat":38.07056,"lng":26.147699,"alt":37000,"spd":521,"ts":1542273732,"hd":137},{"lat":38.180981,"lng":26.017178,"alt":37000,"spd":519,"ts":1542273669,"hd":137},{"lat":38.287632,"lng":25.890535,"alt":37000,"spd":518,"ts":1542273606,"hd":136},{"lat":38.398193,"lng":25.75894,"alt":37000,"spd":519,"ts":1542273546,"hd":136},{"lat":38.508987,"lng":25.626709,"alt":37000,"spd":520,"ts":1542273480,"hd":137},{"lat":38.61969,"lng":25.494013,"alt":37000,"spd":521,"ts":1542273420,"hd":136},{"lat":38.725342,"lng":25.366238,"alt":37000,"spd":521,"ts":1542273356,"hd":136},{"lat":38.835648,"lng":25.232483,"alt":37000,"spd":522,"ts":1542273295,"hd":136},{"lat":38.946346,"lng":25.098145,"alt":37000,"spd":523,"ts":1542273233,"hd":136},{"lat":39.05677,"lng":24.963196,"alt":37000,"spd":523,"ts":1542273168,"hd":136},{"lat":39.16745,"lng":24.826832,"alt":37000,"spd":523,"ts":1542273104,"hd":136},{"lat":39.27277,"lng":24.697205,"alt":37000,"spd":524,"ts":1542273044,"hd":136},{"lat":39.383102,"lng":24.560354,"alt":37000,"spd":525,"ts":1542272982,"hd":136},{"lat":39.494888,"lng":24.420996,"alt":37000,"spd":524,"ts":1542272917,"hd":135},{"lat":39.649292,"lng":24.228077,"alt":37000,"spd":526,"ts":1542272829,"hd":135},{"lat":39.687321,"lng":24.179993,"alt":37000,"spd":527,"ts":1542272807,"hd":135},{"lat":39.792572,"lng":24.047461,"alt":37000,"spd":528,"ts":1542272747,"hd":135},{"lat":39.908627,"lng":23.900635,"alt":37000,"spd":530,"ts":1542272681,"hd":135},{"lat":40.01244,"lng":23.768671,"alt":37000,"spd":531,"ts":1542272623,"hd":135},{"lat":40.118347,"lng":23.632778,"alt":37000,"spd":533,"ts":1542272560,"hd":135},{"lat":40.22942,"lng":23.490705,"alt":37000,"spd":532,"ts":1542272499,"hd":135},{"lat":40.335281,"lng":23.354124,"alt":37000,"spd":532,"ts":1542272436,"hd":135},{"lat":40.446075,"lng":23.209534,"alt":37000,"spd":529,"ts":1542272375,"hd":135},{"lat":40.555435,"lng":23.066406,"alt":37000,"spd":529,"ts":1542272312,"hd":134},{"lat":40.660583,"lng":22.928711,"alt":37000,"spd":533,"ts":1542272251,"hd":134},{"lat":40.769798,"lng":22.784958,"alt":37000,"spd":528,"ts":1542272188,"hd":135},{"lat":40.928543,"lng":22.576591,"alt":37000,"spd":525,"ts":1542272096,"hd":134},{"lat":40.99498,"lng":22.488342,"alt":37000,"spd":521,"ts":1542272056,"hd":134},{"lat":41.096054,"lng":22.353577,"alt":37000,"spd":521,"ts":1542271998,"hd":134},{"lat":41.203125,"lng":22.208984,"alt":37000,"spd":521,"ts":1542271935,"hd":133},{"lat":41.303833,"lng":22.070068,"alt":37000,"spd":521,"ts":1542271871,"hd":134},{"lat":41.415432,"lng":21.929668,"alt":37000,"spd":520,"ts":1542271809,"hd":137},{"lat":41.522873,"lng":21.796429,"alt":37000,"spd":517,"ts":1542271749,"hd":137},{"lat":41.63269,"lng":21.66044,"alt":37000,"spd":513,"ts":1542271685,"hd":136},{"lat":41.737293,"lng":21.529499,"alt":37000,"spd":514,"ts":1542271625,"hd":136},{"lat":41.847061,"lng":21.392191,"alt":37000,"spd":511,"ts":1542271560,"hd":136},{"lat":41.951107,"lng":21.261675,"alt":37000,"spd":512,"ts":1542271501,"hd":136},{"lat":42.059509,"lng":21.124086,"alt":37000,"spd":512,"ts":1542271439,"hd":136},{"lat":42.161896,"lng":20.97603,"alt":37000,"spd":509,"ts":1542271374,"hd":129},{"lat":42.257858,"lng":20.821838,"alt":37000,"spd":510,"ts":1542271312,"hd":129},{"lat":42.348663,"lng":20.675312,"alt":36925,"spd":505,"ts":1542271250,"hd":129},{"lat":42.442142,"lng":20.523163,"alt":36275,"spd":500,"ts":1542271187,"hd":129},{"lat":42.536682,"lng":20.368902,"alt":35050,"spd":507,"ts":1542271124,"hd":129},{"lat":42.625324,"lng":20.223211,"alt":35000,"spd":499,"ts":1542271064,"hd":129},{"lat":42.718056,"lng":20.070488,"alt":35000,"spd":500,"ts":1542271000,"hd":129},{"lat":42.811996,"lng":19.917297,"alt":35000,"spd":497,"ts":1542270937,"hd":129},{"lat":42.900284,"lng":19.7729,"alt":35000,"spd":494,"ts":1542270877,"hd":129},{"lat":42.992615,"lng":19.621326,"alt":35000,"spd":495,"ts":1542270814,"hd":129},{"lat":43.084747,"lng":19.46954,"alt":35000,"spd":497,"ts":1542270750,"hd":129},{"lat":43.177711,"lng":19.315403,"alt":35000,"spd":497,"ts":1542270687,"hd":129},{"lat":43.26947,"lng":19.162647,"alt":35000,"spd":495,"ts":1542270625,"hd":129},{"lat":43.356812,"lng":19.016312,"alt":35000,"spd":493,"ts":1542270563,"hd":129},{"lat":43.44809,"lng":18.86244,"alt":35000,"spd":490,"ts":1542270502,"hd":129},{"lat":43.537628,"lng":18.710995,"alt":35000,"spd":487,"ts":1542270438,"hd":128},{"lat":43.626938,"lng":18.558973,"alt":35000,"spd":484,"ts":1542270374,"hd":128},{"lat":43.717163,"lng":18.404335,"alt":35000,"spd":482,"ts":1542270310,"hd":128},{"lat":43.804184,"lng":18.254869,"alt":35000,"spd":481,"ts":1542270247,"hd":128},{"lat":43.891731,"lng":18.103573,"alt":35000,"spd":481,"ts":1542270186,"hd":128},{"lat":43.991959,"lng":17.92923,"alt":35000,"spd":480,"ts":1542270112,"hd":128},{"lat":44.080917,"lng":17.773851,"alt":35000,"spd":480,"ts":1542270049,"hd":128},{"lat":44.165909,"lng":17.624561,"alt":35000,"spd":479,"ts":1542269984,"hd":128},{"lat":44.252335,"lng":17.471924,"alt":35000,"spd":477,"ts":1542269922,"hd":128},{"lat":44.339355,"lng":17.317265,"alt":35000,"spd":475,"ts":1542269859,"hd":128},{"lat":44.424408,"lng":17.165222,"alt":35000,"spd":471,"ts":1542269796,"hd":127},{"lat":44.509014,"lng":17.013468,"alt":35000,"spd":468,"ts":1542269731,"hd":127},{"lat":44.596252,"lng":16.856363,"alt":35000,"spd":466,"ts":1542269666,"hd":127},{"lat":44.681023,"lng":16.702301,"alt":35000,"spd":464,"ts":1542269602,"hd":127},{"lat":44.764542,"lng":16.5499,"alt":35000,"spd":462,"ts":1542269539,"hd":128},{"lat":44.841751,"lng":16.408278,"alt":35000,"spd":462,"ts":1542269479,"hd":127},{"lat":44.923096,"lng":16.258392,"alt":35000,"spd":461,"ts":1542269415,"hd":127},{"lat":45.005352,"lng":16.106024,"alt":35000,"spd":461,"ts":1542269351,"hd":127},{"lat":45.086636,"lng":15.954627,"alt":35000,"spd":470,"ts":1542269288,"hd":127},{"lat":45.164703,"lng":15.808411,"alt":35000,"spd":468,"ts":1542269229,"hd":127},{"lat":45.281502,"lng":15.58826,"alt":35000,"spd":463,"ts":1542269138,"hd":126},{"lat":45.298958,"lng":15.555167,"alt":35000,"spd":463,"ts":1542269125,"hd":126},{"lat":45.375824,"lng":15.409175,"alt":35000,"spd":460,"ts":1542269064,"hd":126},{"lat":45.452866,"lng":15.262168,"alt":35000,"spd":458,"ts":1542269005,"hd":126},{"lat":45.529018,"lng":15.115914,"alt":35000,"spd":456,"ts":1542268943,"hd":126},{"lat":45.611137,"lng":14.957542,"alt":35000,"spd":457,"ts":1542268878,"hd":126},{"lat":45.687012,"lng":14.810508,"alt":35000,"spd":457,"ts":1542268817,"hd":126},{"lat":45.762772,"lng":14.66293,"alt":35000,"spd":455,"ts":1542268756,"hd":126},{"lat":45.843613,"lng":14.504365,"alt":35000,"spd":451,"ts":1542268691,"hd":125},{"lat":45.917732,"lng":14.358238,"alt":35000,"spd":451,"ts":1542268630,"hd":125},{"lat":45.992065,"lng":14.210749,"alt":35000,"spd":455,"ts":1542268570,"hd":125},{"lat":46.073124,"lng":14.049385,"alt":35000,"spd":455,"ts":1542268504,"hd":125},{"lat":46.148769,"lng":13.897705,"alt":35000,"spd":455,"ts":1542268442,"hd":125},{"lat":46.221439,"lng":13.750763,"alt":35000,"spd":453,"ts":1542268383,"hd":125},{"lat":46.301376,"lng":13.588815,"alt":35000,"spd":460,"ts":1542268317,"hd":125},{"lat":46.376316,"lng":13.437584,"alt":35000,"spd":458,"ts":1542268257,"hd":125},{"lat":46.450424,"lng":13.268738,"alt":35000,"spd":453,"ts":1542268191,"hd":121},{"lat":46.521282,"lng":13.0979,"alt":35000,"spd":452,"ts":1542268125,"hd":120},{"lat":46.586014,"lng":12.940957,"alt":35000,"spd":449,"ts":1542268064,"hd":120},{"lat":46.656933,"lng":12.767624,"alt":35000,"spd":448,"ts":1542267997,"hd":120},{"lat":46.719177,"lng":12.614717,"alt":35000,"spd":449,"ts":1542267938,"hd":120},{"lat":46.7845,"lng":12.453539,"alt":35000,"spd":451,"ts":1542267875,"hd":120},{"lat":46.847286,"lng":12.297615,"alt":35000,"spd":452,"ts":1542267817,"hd":120},{"lat":46.916325,"lng":12.124963,"alt":35000,"spd":452,"ts":1542267751,"hd":120},{"lat":46.980286,"lng":11.96418,"alt":35000,"spd":450,"ts":1542267690,"hd":120},{"lat":47.044693,"lng":11.801239,"alt":35000,"spd":448,"ts":1542267628,"hd":119},{"lat":47.1091,"lng":11.637199,"alt":35000,"spd":440,"ts":1542267565,"hd":119},{"lat":47.190048,"lng":11.384724,"alt":35000,"spd":429,"ts":1542267469,"hd":107},{"lat":47.219471,"lng":11.252112,"alt":35000,"spd":427,"ts":1542267422,"hd":107},{"lat":47.235531,"lng":11.179223,"alt":35000,"spd":427,"ts":1542267395,"hd":107},{"lat":47.272491,"lng":11.01133,"alt":35000,"spd":428,"ts":1542267333,"hd":108},{"lat":47.31189,"lng":10.83039,"alt":35000,"spd":426,"ts":1542267269,"hd":108},{"lat":47.350471,"lng":10.65174,"alt":35000,"spd":427,"ts":1542267203,"hd":108},{"lat":47.389252,"lng":10.47089,"alt":35000,"spd":429,"ts":1542267139,"hd":108},{"lat":47.42765,"lng":10.29018,"alt":35000,"spd":430,"ts":1542267074,"hd":107},{"lat":47.466339,"lng":10.1063,"alt":35000,"spd":432,"ts":1542267008,"hd":107},{"lat":47.504009,"lng":9.92553,"alt":34200,"spd":432,"ts":1542266943,"hd":107},{"lat":47.54237,"lng":9.74007,"alt":33050,"spd":430,"ts":1542266879,"hd":107},{"lat":47.578709,"lng":9.5617,"alt":33000,"spd":428,"ts":1542266814,"hd":107},{"lat":47.61335,"lng":9.39049,"alt":32825,"spd":424,"ts":1542266753,"hd":107},{"lat":47.649349,"lng":9.21135,"alt":31750,"spd":423,"ts":1542266689,"hd":107},{"lat":47.685883,"lng":9.02932,"alt":29675,"spd":436,"ts":1542266624,"hd":106},{"lat":47.720078,"lng":8.856079,"alt":28900,"spd":437,"ts":1542266563,"hd":106},{"lat":47.756592,"lng":8.67103,"alt":27475,"spd":428,"ts":1542266498,"hd":106},{"lat":47.793869,"lng":8.477669,"alt":25800,"spd":415,"ts":1542266429,"hd":104},{"lat":47.796661,"lng":8.461052,"alt":25650,"spd":415,"ts":1542266423,"hd":104},{"lat":47.801933,"lng":8.435528,"alt":25425,"spd":413,"ts":1542266413,"hd":113},{"lat":47.810394,"lng":8.410927,"alt":25175,"spd":411,"ts":1542266403,"hd":124},{"lat":47.82251,"lng":8.388625,"alt":24900,"spd":409,"ts":1542266393,"hd":137},{"lat":47.837082,"lng":8.371719,"alt":24625,"spd":409,"ts":1542266383,"hd":150},{"lat":47.881714,"lng":8.347481,"alt":23950,"spd":406,"ts":1542266358,"hd":162},{"lat":47.996567,"lng":8.293692,"alt":22150,"spd":393,"ts":1542266293,"hd":162},{"lat":48.126709,"lng":8.232399,"alt":19100,"spd":391,"ts":1542266220,"hd":162},{"lat":48.182217,"lng":8.206137,"alt":17875,"spd":382,"ts":1542266187,"hd":162},{"lat":48.237476,"lng":8.179972,"alt":16650,"spd":372,"ts":1542266154,"hd":162},{"lat":48.291641,"lng":8.154321,"alt":15250,"spd":364,"ts":1542266120,"hd":162},{"lat":48.343987,"lng":8.129449,"alt":13800,"spd":355,"ts":1542266089,"hd":162},{"lat":48.39798,"lng":8.103474,"alt":12175,"spd":352,"ts":1542266052,"hd":162},{"lat":48.413769,"lng":8.095912,"alt":11775,"spd":348,"ts":1542266042,"hd":162},{"lat":48.432064,"lng":8.087094,"alt":11300,"spd":344,"ts":1542266031,"hd":162},{"lat":48.451336,"lng":8.07777,"alt":11000,"spd":333,"ts":1542266017,"hd":162},{"lat":48.468143,"lng":8.069603,"alt":10800,"spd":321,"ts":1542266006,"hd":162},{"lat":48.485092,"lng":8.0615,"alt":10575,"spd":307,"ts":1542265993,"hd":162},{"lat":48.500519,"lng":8.054175,"alt":10400,"spd":292,"ts":1542265981,"hd":162},{"lat":48.516602,"lng":8.046618,"alt":9950,"spd":286,"ts":1542265971,"hd":162},{"lat":48.532711,"lng":8.039101,"alt":9450,"spd":281,"ts":1542265957,"hd":163},{"lat":48.542625,"lng":8.034619,"alt":9125,"spd":279,"ts":1542265949,"hd":163},{"lat":48.550278,"lng":8.031076,"alt":8850,"spd":277,"ts":1542265942,"hd":159},{"lat":48.564178,"lng":8.022188,"alt":8350,"spd":275,"ts":1542265932,"hd":153},{"lat":48.577652,"lng":8.012132,"alt":7775,"spd":274,"ts":1542265919,"hd":153},{"lat":48.591248,"lng":8.00199,"alt":7225,"spd":272,"ts":1542265907,"hd":153},{"lat":48.605118,"lng":7.991216,"alt":6625,"spd":271,"ts":1542265894,"hd":152},{"lat":48.617798,"lng":7.980793,"alt":6100,"spd":267,"ts":1542265885,"hd":151},{"lat":48.624893,"lng":7.97537,"alt":5800,"spd":268,"ts":1542265877,"hd":158},{"lat":48.654236,"lng":7.968961,"alt":4725,"spd":264,"ts":1542265853,"hd":189},{"lat":48.663849,"lng":7.973183,"alt":4400,"spd":263,"ts":1542265844,"hd":206},{"lat":48.670441,"lng":7.97868,"alt":4150,"spd":260,"ts":1542265837,"hd":211},{"lat":48.68248,"lng":7.989878,"alt":3875,"spd":246,"ts":1542265827,"hd":211},{"lat":48.688248,"lng":7.99523,"alt":3750,"spd":237,"ts":1542265821,"hd":211},{"lat":48.699005,"lng":8.005371,"alt":3500,"spd":218,"ts":1542265808,"hd":212},{"lat":48.709377,"lng":8.015249,"alt":2925,"spd":218,"ts":1542265797,"hd":212},{"lat":48.714497,"lng":8.020164,"alt":2650,"spd":217,"ts":1542265790,"hd":212},{"lat":48.71957,"lng":8.025151,"alt":2325,"spd":219,"ts":1542265783,"hd":212},{"lat":48.725388,"lng":8.030789,"alt":2025,"spd":219,"ts":1542265777,"hd":212},{"lat":48.786015,"lng":8.086747,"alt":0,"spd":92,"ts":1542265689,"hd":210},{"lat":48.789585,"lng":8.090093,"alt":0,"spd":36,"ts":1542265675,"hd":210},{"lat":48.78574,"lng":8.089406,"alt":0,"spd":33,"ts":1542265498,"hd":30},{"lat":48.785385,"lng":8.089064,"alt":0,"spd":32,"ts":1542265491,"hd":30},{"lat":48.784378,"lng":8.08812,"alt":0,"spd":33,"ts":1542265472,"hd":30},{"lat":48.783054,"lng":8.086877,"alt":0,"spd":28,"ts":1542265448,"hd":30},{"lat":48.782696,"lng":8.086552,"alt":0,"spd":26,"ts":1542265440,"hd":30},{"lat":48.782265,"lng":8.086136,"alt":0,"spd":27,"ts":1542265431,"hd":33},{"lat":48.781815,"lng":8.085761,"alt":0,"spd":24,"ts":1542265420,"hd":14},{"lat":48.781475,"lng":8.085938,"alt":0,"spd":22,"ts":1542265410,"hd":306},{"lat":48.781071,"lng":8.08687,"alt":0,"spd":23,"ts":1542265395,"hd":303},{"lat":48.780315,"lng":8.086994,"alt":0,"spd":19,"ts":1542265370,"hd":30},{"lat":48.780006,"lng":8.086801,"alt":0,"spd":17,"ts":1542265359,"hd":359},{"lat":48.779743,"lng":8.086853,"alt":0,"spd":16,"ts":1542265351,"hd":339},{"lat":48.779549,"lng":8.087082,"alt":0,"spd":15,"ts":1542265339,"hd":271},{"lat":48.779648,"lng":8.087347,"alt":0,"spd":0,"ts":1542265306,"hd":174},{"lat":48.77964,"lng":8.087346,"alt":0,"spd":0,"ts":1542265141,"hd":0}],"firstTimestamp":1542265141,"s":"5dRYZIskJ4j_kii3xhYMJU0pELvaLcXj8TfFTF2j1IgExCQpUNFY-Z8soqJXJL--"}
  def getHistoricalData(str: String): Historical = {
    val splitRegex = "\"level\"|\"airline\"|\"owner\"|\"airspace\"|\"flightHistory\"|\"ems\"|\"availability\"|\"scheduled\":|\"trail\"|\"firstTimestamp\""
    val parts = str.split(splitRegex)
    val firstdata = parts(0)

    val firstREGEX = ".*id\":\"(\\w*).*callsign\":\"?(\\w*).*" r
    val firstREGEX(identificationId, identificationCallsign) = firstdata
    val secondData = parts(1)
    //    println(secondData)
    val aircraftModelCode = secondData.split("\",\"text\"")(0).split("\"code\":\"")(1)
    val FIFTHDataTMP = parts(4).split("origin|destination")
      .filter(str => str.contains("country"))
      .flatMap(s => s.split("country|city"))
      .filter(str => !str.contains("latitude"))

    val FIFTHDataTMP_1 = FIFTHDataTMP.filter(str => str.contains("code")).map(str => str.split("\"")(4))
    val FIFTHDataTMP_2 = FIFTHDataTMP.filter(str => !str.contains("code")).map(str => str.split("\"")(2))
    //
    //    println("===============")
    //    FIFTHDataTMP.foreach(println)
    //    println(parts(4))
    //    FIFTHDataTMP_1.foreach(println)
    //    FIFTHDataTMP_2.foreach(println)
    //    println("===============")

    var countruOrigin, countruDest, cityOrigin, cityDest = ""

    //    println(FIFTHDataTMP_1.length)
    if (FIFTHDataTMP_1.length == 2) {
      countruOrigin = FIFTHDataTMP_1(0)
      countruDest = FIFTHDataTMP_1(1)
    }

    if (FIFTHDataTMP_1.length == 2) {
      cityOrigin = FIFTHDataTMP_2(0)
      cityDest = FIFTHDataTMP_2(1)
    }


    val timedata = timePArcer(parts(8))
    val traectory = TRAECTORYPArcer(parts(9))

    Historical(identificationId, identificationCallsign, aircraftModelCode, countruDest, countruOrigin, cityDest, cityOrigin, timedata, traectory)
  }

  def HistoricalDataToBasicDBObject(historical: Historical): BasicDBObject = {
    val document = new BasicDBObject
    //    Historical(id: String, callsign: String, aircraftModelCode: String, countruDest: String, countruOrigin: String, cityDest: String, cityOrigin: String, timeData: TimeData, traectory: Array[Traectory])
    document.append("id", historical.id)
    document.append("callsign", historical.callsign)
    document.append("aircraftModelCode", historical.aircraftModelCode)
    document.append("countruDest", historical.countruDest)
    document.append("countruOrigin", historical.countruOrigin)
    document.append("cityDest", historical.cityDest)
    document.append("cityOrigin", historical.cityOrigin)
    PopulateDbObjectByTimeData(historical.timeData, document)
    document.append("traectory", TraectoryArrayTOBasicDBObject(historical.traectory))

    document
  }

  def PopulateDbObjectByTimeData(timedata: TimeData, document: BasicDBObject): Unit = {
    document.append("scheduledDeparture", timedata.scheduledDeparture)
    document.append("scheduledArrival", timedata.scheduledArrival)
    document.append("realDeparture", timedata.realDeparture)
    document.append("realArrival", timedata.realArrival)
    document.append("estimatedETA", timedata.estimatedETA)
    document.append("estimatedUpdated", timedata.estimatedUpdated)
    document.append("otherETA", timedata.otherETA)
    document.append("otherUpdated", timedata.otherUpdated)
    document.append("historicalFlighttime", timedata.historicalFlighttime)
    document.append("historicalDelay", timedata.historicalDelay)
  }

  def TraectoryArrayTOBasicDBObject(timedata: Array[Traectory]): BasicDBList = {
    val global = new BasicDBList
    timedata.map(TraectoryTOBasicDBObject).foreach(t => global.add(t))
    global
  }

  def TraectoryTOBasicDBObject(traectory: Traectory): BasicDBObject = {
    val t = new BasicDBObject
    t.append("lat", traectory.lat)
    t.append("lng", traectory.lng)
    t.append("alt", traectory.alt)
    t.append("spd", traectory.spd)
    t.append("ts", traectory.ts)
    t.append("hd", traectory.hd)
    t
  }

}
